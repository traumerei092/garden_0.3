# サードプレイス発見アプリケーション - 開発ドキュメント

## 🏛️ プロジェクト概要

現代社会において、社会的なつながりが減少し孤独感を感じる人が増加している中で、誰しもが閉塞感を取り払い、QOLを上げることができる**サードプレイス**を見つけることができるサービスです。

サードプレイスとなり得る場所はカフェやジムなど様々ありますが、特に**バーやスナック**はサードプレイスになり得るポテンシャルを持っている場所として、これらを軸に「**頑張らずに行けて気楽になれる場所**」を探すことができるアプリケーションの開発を目指しています。

### 🎯 ミッション
**「一人でも安心して足を運べるサードプレイスの発見を支援し、現代社会の孤独感解消とQOL向上に貢献する」**

### 🛠️ 技術スタック
- **フロントエンド**: Next.js 14 (App Router) + TypeScript + Zustand + SCSS Modules
- **バックエンド**: Django REST Framework + PostgreSQL/PostGIS + JWT認証
- **インフラ**: RESTful API設計 + Cloudinary（画像管理）

---

## 📋 Claude Code開発記録 - インデックス

このディレクトリには、Claude Codeとの開発セッションで実装した機能ごとの詳細記録が保存されています。

### 🚀 実装済み機能一覧

#### ✅ 基本システム
- **ユーザー認証・プロフィール管理**: JWT認証システム、詳細プロフィール設定
- **店舗情報管理・検索**: 地理空間データ対応の店舗管理
- **マイエリア機能**: 階層構造を持つ地理的エリア選択

#### 🗨️ [口コミ機能](./CLAUDE_ShopReview.md)
**実装日**: 2025-08-03  
**概要**: Netflix品質のUI/UXを持つ口コミシステム
- 時系列レビューリンク機能
- 高度なフィルタリング（来店目的・頻度）
- グラスモーフィズムデザイン

#### 🎯 [共通点分析機能](./CLAUDE_CommonPoints.md)
**実装日**: 2025-09-05  
**概要**: 透明性のある共通点表示によるサードプレイス適合性判断システム
- マッチ率70%を具体的共通点に置き換え
- Phase1: 年齢・性別、雰囲気の好み、来店目的
- 「6人の常連さんがあなたと同じ30代・男性です」形式

#### 🏆 [店舗関係性管理](./CLAUDE_ShopRelation.md)
**実装日**: 2025-08-03  
**概要**: 3段階の店舗関係性管理システム
- 行きつけ・行った・気になる の管理
- 専用ページとリアルタイム統計
- Crown/Star/Heart アイコンシステム

#### 🌈 [店舗雰囲気フィードバック](./CLAUDE_AtmosphereFeedback.md)
**実装日**: 2025-08-25  
**概要**: 雰囲気フィードバック収集・集計・可視化システム
- ステップ式フィードバック入力（雰囲気評価→印象タグ）
- -2〜+2の多軸評価システム
- グラデーション可視化による直感的な雰囲気表示

#### ⚙️ [開発ガイドライン](./CLAUDE_DevelopmentGuidelines.md)
**更新日**: 2025-08-27
**概要**: プロジェクト開発における必須ルールとベストプラクティス
- API連携パターン（fetchWithAuth）
- 型定義の管理方針
- プロジェクト構成とコマンド

### 🔄 開発中の重要機能

#### 店舗雰囲気フィードバックシステム（完成）
**目的**: 新規客が事前に店舗の雰囲気を正確に把握し、安心して訪問できる環境の提供

**主要コンポーネント**:
1. **フィードバック収集機能**: 「行った」ボタン押下時のモーダル表示、ステップ形式入力
2. **雰囲気データ集計・可視化機能**: 平均値計算、グラデーション表示による直感的可視化
3. **常連客と新規客の区別機能**: 利用頻度に基づく自動判定、信頼性の高い情報提供

## 🗂️ ファイル管理ルール

### 命名規則
```
CLAUDE_{機能名or開発箇所}.md
```

### ファイル構成
```
Readme/
├── README.md                           # このファイル（メインドキュメント）
├── CLAUDE_DevelopmentGuidelines.md    # 開発ガイドライン
├── CLAUDE_ShopReview.md               # 口コミ機能
├── CLAUDE_ShopRelation.md             # 店舗関係性管理
├── CLAUDE_AtmosphereFeedback.md       # 雰囲気フィードバック
├── CLAUDE_AreaManagement.md           # エリア管理機能
├── CLAUDE_ProfileRecommendation.md    # プロフィールレコメンド
└── CLAUDE_{NextFeature}.md            # 今後の機能記録
```

### テンプレート構成
各機能記録ファイルは以下の構成で統一：

```markdown
# {機能名} - Claude Code開発記録

## 📋 実装概要
## 🎯 主要機能  
## 🔧 技術実装詳細
## 📁 関連ファイル一覧
## 🎨 デザインシステム
## 🐛 解決した技術課題
## 🔄 Claude Code相談履歴
## 🚀 今後の拡張案
## 📝 メンテナンス情報
```

## 🔗 機能間の関連性

### 口コミ機能 ↔ 店舗関係性管理
- 口コミフィルタで「行きつけ」「ビギナー」分類
- 関係性に基づくレビュー表示優先度
- 統合された統計データ管理

### 雰囲気フィードバック ↔ 店舗関係性管理
- 「行った」ボタン押下時の雰囲気フィードバック収集
- 常連客/新規客の区別による信頼性重み付け
- 訪問履歴との連携

## 📊 プロジェクト統計

### 実装済み機能数: 5
### 関連ファイル数: 55+
### 新規エンドポイント数: 9
### 新規ページ数: 4
### データモデル数: 10+

## 📁 プロジェクト構成

```
├── backend/                 # Django REST Framework
│   ├── accounts/           # ユーザー管理・認証
│   ├── shops/              # 店舗管理・関係性・レビュー・雰囲気
│   └── garden/             # プロジェクト設定
├── frontend/               # Next.js アプリケーション
│   ├── src/app/            # App Router
│   ├── src/components/     # UIコンポーネント
│   ├── src/actions/        # API通信・データ処理層（必須）
│   ├── src/store/          # 状態管理
│   └── src/types/          # TypeScript型定義
├── Readme/                 # 開発記録・ドキュメント
└── README.md              # このファイル
```

## 🚨 重要な実装ルール

### データ処理の配置
**全てのAPI通信とデータ処理は `frontend/src/actions/` 配下に実装する**

- ❌ **禁止**: コンポーネント内でのAPI通信・データ処理
- ✅ **必須**: actions層での処理を分離し、コンポーネントから呼び出す

#### 命名規則:
```
src/actions/
├── shop/           # 店舗関連
│   ├── fetchShop.ts
│   ├── commonalities.ts
│   └── ...
├── profile/        # プロフィール関連
└── auth/           # 認証関連
```

### 実装例:
```typescript
// ❌ 悪い例: コンポーネント内でAPI処理
const Component = () => {
  const [data, setData] = useState(null);
  
  useEffect(() => {
    fetch('/api/data').then(res => res.json()).then(setData);
  }, []);
  
  return <div>{data}</div>;
};

// ✅ 良い例: actions層で分離
// actions/shop/fetchData.ts
export const fetchData = async () => {
  const response = await fetchWithAuth('/api/data');
  return response.json();
};

// Component.tsx
const Component = () => {
  const [data, setData] = useState(null);
  
  useEffect(() => {
    fetchData().then(setData);
  }, []);
  
  return <div>{data}</div>;
};
```

## 🎯 次回開発時の参照方法

1. **機能拡張時**: 関連する既存機能の記録を確認
2. **新機能開発時**: 既存のデザインシステムとの整合性確認
3. **バグ修正時**: 過去の解決済み課題を参照
4. **チーム引き継ぎ時**: 全体構成と個別機能の詳細確認

## 📝 記録追加時の手順

1. 新しい `CLAUDE_{機能名}.md` ファイルを作成
2. 上記テンプレート構成に従って記録
3. このREADME.mdの機能一覧を更新
4. 関連性がある場合は相互リンクを追加

## 🚀 ビジョン・ロードマップ

### Phase 1 (完了)
- 基本的な店舗検索・管理機能
- ユーザー認証・プロフィール機能
- 店舗関係性管理

### Phase 2 (完了)
- **店舗雰囲気フィードバックシステム**の実装
- 常連客/新規客区別機能
- 高度な雰囲気可視化

### Phase 3 (将来)
- マスターメッセージ機能
- コミュニティ機能
- AIによるレコメンデーション

### 最終目標
**誰もが安心して一人で足を運べるサードプレイスのネットワークを構築し、現代社会の孤独感解消とQOL向上に貢献する**

---

**プロジェクト**: Third Place Discovery Platform  
**Claude Code Version**: Sonnet 4  
**最終更新**: 2025-08-27